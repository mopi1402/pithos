{
  "src/lib/schemas.ts": {
    "content": "/**\n * Kanon schemas for validating API responses\n * Using Pithos/Kanon v3 for schema validation\n */\nimport {\n  object,\n  string,\n  number,\n  boolean,\n  array,\n  optional,\n} from \"pithos/kanon/index\";\n\n// Define the expected API response structure\nexport const UserSchema = object({\n  id: string(),\n  firstName: string(),\n  lastName: string(),\n  email: string().email(),\n  role: string(),\n  createdAt: string(),\n  preferences: optional(\n    object({\n      theme: optional(string()),\n      language: optional(string()),\n      notifications: optional(boolean()),\n    })\n  ),\n});\n\nexport const PostSchema = object({\n  id: string(),\n  title: string(),\n  content: string(),\n  publishedAt: optional(string()),\n  status: string(),\n});\n\nexport const DashboardSchema = object({\n  user: UserSchema,\n  posts: array(PostSchema),\n  stats: object({\n    totalViews: number(),\n    totalLikes: number(),\n    totalComments: number(),\n  }),\n});\n",
    "label": "schemas.ts",
    "step": 1
  },
  "src/lib/api.ts": {
    "content": "/**\n * Safe API helpers using Zygos ResultAsync\n * \n * This file demonstrates the Zygos pattern for type-safe async operations.\n * In this example, we use mock data, but the pattern works identically with real APIs.\n */\nimport { ResultAsync, errAsync, okAsync } from \"pithos/zygos/result/result-async\";\nimport { parse } from \"pithos/kanon/index\";\nimport { DashboardSchema } from \"./schemas\";\nimport { formatUser, formatPosts } from \"./transformers\";\nimport type { DashboardData, RawDashboardData } from \"./types\";\n\n/**\n * Load dashboard data with full error handling pipeline\n * \n * This demonstrates the Zygos ResultAsync pattern:\n * 1. Wrap async operations in ResultAsync\n * 2. Chain with andThen for sequential operations\n * 3. Use map for transformations\n * 4. All errors are captured and typed\n */\nexport function loadDashboard(userId: string): ResultAsync<DashboardData, string> {\n  return ResultAsync.fromPromise(\n    fetch(`/api/dashboard/${userId}`),\n    (error) => `Network error: ${error}`\n  )\n    .andThen((response) => {\n      if (!response.ok) {\n        return errAsync(`HTTP error: ${response.status}`);\n      }\n      return ResultAsync.fromPromise(\n        response.json() as Promise<unknown>,\n        (error) => `JSON parse error: ${error}`\n      );\n    })\n    .andThen((data) => {\n      const result = parse(DashboardSchema, data);\n\n      if (!result.success) {\n        return errAsync(`Invalid data: ${result.error}`);\n      }\n\n      // Safe cast: parse() validates that data matches RawDashboardData structure\n      return okAsync(result.data as RawDashboardData);\n    })\n    .map((data) => ({\n      user: formatUser(data.user),\n      posts: formatPosts(data.posts),\n      stats: data.stats,\n    }));\n}\n",
    "label": "api.ts",
    "step": 2
  },
  "src/lib/transformers.ts": {
    "content": "/**\n * Data transformers using Arkhe utilities\n */\nimport { groupBy } from \"pithos/arkhe/array/group-by\";\nimport { capitalize } from \"pithos/arkhe/string/capitalize\";\nimport type { User, Post, FormattedUser, FormattedPosts } from \"./types\";\n\n/**\n * Transform user data for display\n */\nexport function formatUser(user: User): FormattedUser {\n  const defaultPrefs = {\n    theme: \"light\",\n    language: \"en\",\n    notifications: true,\n  };\n\n  return {\n    id: user.id,\n    fullName: `${capitalize(user.firstName)} ${capitalize(user.lastName)}`,\n    email: user.email,\n    role: capitalize(user.role),\n    preferences: {\n      theme: user.preferences?.theme ?? defaultPrefs.theme,\n      language: user.preferences?.language ?? defaultPrefs.language,\n      notifications: user.preferences?.notifications ?? defaultPrefs.notifications,\n    },\n  };\n}\n\n/**\n * Transform posts for the dashboard, grouped by status\n */\nexport function formatPosts(posts: Post[]): FormattedPosts {\n  const grouped = groupBy(posts, (post) => post.status);\n\n  return {\n    published: grouped[\"published\"] ?? [],\n    draft: grouped[\"draft\"] ?? [],\n    total: posts.length,\n  };\n}\n",
    "label": "transformers.ts",
    "step": 3
  },
  "src/lib/types.ts": {
    "content": "/**\n * TypeScript types for the dashboard\n */\n\nexport type User = {\n  id: string;\n  firstName: string;\n  lastName: string;\n  email: string;\n  role: string;\n  createdAt: string;\n  preferences?: {\n    theme?: string;\n    language?: string;\n    notifications?: boolean;\n  };\n};\n\nexport type Post = {\n  id: string;\n  title: string;\n  content: string;\n  publishedAt?: string;\n  status: string;\n};\n\nexport type Stats = {\n  totalViews: number;\n  totalLikes: number;\n  totalComments: number;\n};\n\nexport type RawDashboardData = {\n  user: User;\n  posts: Post[];\n  stats: Stats;\n};\n\nexport type FormattedUser = {\n  id: string;\n  fullName: string;\n  email: string;\n  role: string;\n  preferences: {\n    theme: string;\n    language: string;\n    notifications: boolean;\n  };\n};\n\nexport type FormattedPosts = {\n  published: Post[];\n  draft: Post[];\n  total: number;\n};\n\nexport type DashboardData = {\n  user: FormattedUser;\n  posts: FormattedPosts;\n  stats: Stats;\n};\n",
    "label": "types.ts",
    "step": 0
  },
  "src/hooks/useDashboard.ts": {
    "content": "/**\n * Custom hook for loading dashboard data\n * Demonstrates the Pithos pipeline in a React context\n */\nimport { useState, useEffect, useCallback } from \"react\";\nimport { parse } from \"pithos/kanon/index\";\nimport { DashboardSchema } from \"@/lib/schemas\";\nimport { formatUser, formatPosts } from \"@/lib/transformers\";\nimport { mockDashboardData } from \"@/lib/mock-data\";\nimport type { DashboardData, RawDashboardData } from \"@/lib/types\";\n\ntype DashboardState =\n  | { status: \"idle\" }\n  | { status: \"loading\" }\n  | { status: \"success\"; data: DashboardData }\n  | { status: \"error\"; error: string };\n\n/**\n * Simulates the full Pithos pipeline with mock data\n * In production, this would use the loadDashboard function from api.ts\n */\nexport function useDashboard(userId: string) {\n  const [state, setState] = useState<DashboardState>({ status: \"idle\" });\n\n  const load = useCallback(async () => {\n    setState({ status: \"loading\" });\n\n    // Simulate network delay\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n\n    try {\n      // Step 1: Validate with Kanon\n      const result = parse(DashboardSchema, mockDashboardData);\n\n      if (!result.success) {\n        setState({ status: \"error\", error: `Validation failed: ${result.error}` });\n        return;\n      }\n\n      const rawData = result.data as RawDashboardData;\n\n      // Step 2: Transform with Arkhe utilities\n      const dashboardData: DashboardData = {\n        user: formatUser(rawData.user),\n        posts: formatPosts(rawData.posts),\n        stats: rawData.stats,\n      };\n\n      setState({ status: \"success\", data: dashboardData });\n    } catch (err) {\n      setState({ status: \"error\", error: `Unexpected error: ${err}` });\n    }\n  }, [userId]);\n\n  useEffect(() => {\n    load();\n  }, [load]);\n\n  return { state, reload: load };\n}\n",
    "label": "useDashboard.ts",
    "step": 5
  },
  "src/components/Dashboard/index.tsx": {
    "content": "import { useDashboard } from \"@/hooks/useDashboard\";\nimport { Header } from \"./Header\";\nimport { StatsCards } from \"./StatsCards\";\nimport { PostsList } from \"./PostsList\";\nimport { LoadingSkeleton } from \"./LoadingSkeleton\";\nimport { ErrorDisplay } from \"./ErrorDisplay\";\nimport { DemoControls } from \"./DemoControls\";\n\nexport function Dashboard() {\n  const { state, reload } = useDashboard(\"user-123\");\n\n  if (state.status === \"idle\" || state.status === \"loading\") {\n    return <LoadingSkeleton />;\n  }\n\n  if (state.status === \"error\") {\n    return <ErrorDisplay error={state.error} onRetry={reload} />;\n  }\n\n  const { user, posts, stats } = state.data;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header user={user} />\n\n      <main className=\"container mx-auto space-y-6 px-4 py-6\">\n        <StatsCards stats={stats} />\n\n        <div className=\"grid gap-6 lg:grid-cols-2\">\n          <PostsList\n            posts={posts.published}\n            title=\"Published Posts\"\n            description=\"Your live content\"\n            variant=\"published\"\n          />\n          <PostsList\n            posts={posts.draft}\n            title=\"Drafts\"\n            description=\"Work in progress\"\n            variant=\"draft\"\n          />\n        </div>\n\n        {/* Demo controls for testing error handling */}\n        <DemoControls />\n\n        {/* Pithos info card */}\n        <div className=\"rounded-lg border bg-muted/50 p-4\">\n          <h3 className=\"font-semibold\">âœ¨ Powered by Pithos</h3>\n          <p className=\"mt-1 text-sm text-muted-foreground\">\n            This dashboard uses <strong>Kanon</strong> for schema validation,{\" \"}\n            <strong>Arkhe</strong> for data transformation (capitalize, groupBy), and{\" \"}\n            <strong>Zygos</strong> patterns for type-safe error handling.\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n}\n",
    "label": "Dashboard.tsx",
    "step": 5
  }
}